{
  "version": 3,
  "file": "s3.js",
  "sourceRoot": "../src/",
  "sources": [
    "s3.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "'use strict'\r\n\r\nsettings = require './settings'\r\nAWS = require 'aws-sdk'\r\nstream = require 'stream'\r\n\r\nmodule.exports = ->\r\n  AWS.config.bucket = settings.AWS_BUCKET\r\n  AWS.config.region = settings.AWS_REGION\r\n  AWS.config.accessKeyId = settings.AWS_ID\r\n  AWS.config.secretAccessKey = settings.AWS_KEY\r\n  S3 = new AWS.S3()\r\n  s3Stream = require('s3-upload-stream') S3\r\n  dbs: (cb) ->\r\n    S3.listBuckets {}, (e, r) ->\r\n      cb? e, r\r\n  keys: (from, prefix, cb) ->\r\n    m =\r\n      Bucket: AWS.config.bucket\r\n      Prefix: prefix\r\n    if from\r\n      m.Marker = from\r\n    S3.listObjects m, (e, r) ->\r\n      cb? e, r\r\n  del: (key, cb) ->\r\n    m =\r\n      Bucket: AWS.config.bucket\r\n      Key: key\r\n    S3.deleteObject m, (e, r) ->\r\n      cb? e, r\r\n  put: (key, o, cb) ->\r\n    m =\r\n      Bucket: AWS.config.bucket\r\n      Key: key\r\n      Body: JSON.stringify o\r\n      ContentType: 'application/json'\r\n    S3.putObject m, (e, r) ->\r\n      cb? e, r\r\n  get: (key, cb) ->\r\n    m =\r\n      Bucket: AWS.config.bucket\r\n      Key: key\r\n    S3.getObject m, (e, r) ->\r\n      if e or not r.Body\r\n        return cb?(e or 'error', null)\r\n      d = null\r\n      try\r\n        d = JSON.parse r.Body\r\n      catch e\r\n        return cb?(e or 'error', null)\r\n      cb? null, d\r\n  getReadStream: (key) ->\r\n    m =\r\n      Bucket: AWS.config.bucket\r\n      Key: key\r\n    S3.getObject(m).createReadStream()\r\n  getWriteStream: (key) ->\r\n    upload = s3Stream.upload\r\n      Bucket: AWS.config.bucket\r\n      Key: key\r\n    upload"
  ]
}